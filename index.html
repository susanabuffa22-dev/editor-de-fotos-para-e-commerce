<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor de Fotos E-commerce</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>Editor de Fotos E-commerce</h1>
            <p class="subtitle">Edita tus fotos de productos con herramientas profesionales</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel - Image Upload -->
            <div class="panel upload-panel">
                <h2>Cargar Imágenes</h2>
                
                <!-- Person Image Upload -->
                <div class="upload-section">
                    <label class="upload-label">
                        <input type="file" id="imageUpload" accept="image/*" class="file-input">
                        <div class="upload-area" id="personUploadArea">
                            <svg class="upload-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                            </svg>
                            <h3>Arrastra tu imagen aquí</h3>
                            <p class="upload-text">o haz clic para seleccionar archivo</p>
                            <p class="upload-hint">JPG, PNG hasta 10MB</p>
                        </div>
                    </label>
                    <div class="image-preview" id="personPreview" style="display: none;">
                        <img id="personImage" alt="Vista previa">
                    </div>
                </div>

                <!-- Garment Image Upload (Hidden until person image is loaded) -->
                <div class="upload-section" id="garmentSection" style="display: none;">
                    <label class="upload-label">
                        <input type="file" id="garmentUpload" accept="image/*" class="file-input">
                        <div class="upload-area garment-upload" id="garmentUploadArea">
                            <svg class="upload-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                            </svg>
                            <h3>Cargar Prenda (Opcional)</h3>
                            <p class="upload-text">Para virtual try-on</p>
                        </div>
                    </label>
                    <div class="image-preview" id="garmentPreview" style="display: none;">
                        <img id="garmentImage" alt="Vista previa prenda">
                    </div>
                </div>
            </div>

            <!-- Center Panel - Tools -->
            <div class="panel tools-panel">
                <h2>Herramientas</h2>
                <fieldset id="controls" class="tools-fieldset" disabled>
                    <button class="tool-btn" id="btn-white-bg" data-prompt="fondo blanco">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        </svg>
                        <span>Fondo Blanco</span>
                    </button>

                    <button class="tool-btn" id="btn-square-format" data-prompt="formato cuadrado">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                            <polyline points="9,22 9,12 15,12 15,22"/>
                        </svg>
                        <span>Formato Cuadrado</span>
                    </button>

                    <button class="tool-btn" id="btn-smile" data-prompt="hacer sonreír">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                            <line x1="9" y1="9" x2="9.01" y2="9"/>
                            <line x1="15" y1="9" x2="15.01" y2="9"/>
                        </svg>
                        <span>Sonreír</span>
                    </button>

                    <button class="tool-btn" id="btn-virtual-try-on" data-prompt="virtual try-on">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                        <span>Poner Ropa</span>
                    </button>
                </fieldset>
            </div>

            <!-- Right Panel - Preview -->
            <div class="panel preview-panel">
                <h2>Vista Previa</h2>
                
                <div class="preview-container">
                    <div class="preview-box">
                        <h3>Original</h3>
                        <div class="image-display" id="originalImage">
                            <div class="placeholder">
                                <p>Sube una imagen para comenzar</p>
                            </div>
                        </div>
                    </div>

                    <div class="preview-box">
                        <h3>Editada</h3>
                        <div class="image-display" id="editedImage">
                            <div class="placeholder">
                                <p>El resultado aparecerá aquí</p>
                            </div>
                            <div class="loader" id="loader" style="display: none;">
                                <div class="spinner"></div>
                                <p>Procesando...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Actions -->
        <footer class="actions-footer">
            <button class="action-btn secondary" id="btn-retry" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23,4 23,10 17,10"/>
                    <polyline points="1,20 1,14 7,14"/>
                    <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                </svg>
                Generar Otra Vez
            </button>
            <button class="action-btn secondary" id="btn-canva-export" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M4 9V5a2 2 0 012-2h4m8 0V5a2 2 0 012-2h4M4 15v4h16v-4"/>
                </svg>
                Enviar a Canva Pro
            </button>
            <button class="action-btn primary" id="btn-download" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                    <polyline points="7,10 12,15 17,10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Descargar
            </button>
        </footer>
    </div>

    <!-- API Key Notice -->
    <div class="api-notice" id="apiNotice">
        <div class="notice-content">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>Para usar esta aplicación, configura tu API Key de Google AI en el código JavaScript</span>
        </div>
    </div>

    <!-- Canva Integration Panel -->
    <div class="canva-panel" id="canvaPanel">
        <div class="canva-header">
            <h3>Integración con Canva Pro</h3>
            <div class="canva-status" id="canvaStatus">
                <span class="status-indicator" id="canvaIndicator"></span>
                <span id="canvaStatusText">Desconectado</span>
            </div>
        </div>
        <div class="canva-content">
            <p>Conecta tu cuenta de Canva Pro para exportar diseños directamente a la plataforma.</p>
            <div class="canva-actions">
                <button class="canva-connect-btn" id="btnCanvaConnect" onclick="window.CanvaIntegration?.startOAuth()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                        <circle cx="8.5" cy="7" r="4"/>
                        <path d="M20 8v6M23 11h-6"/>
                    </svg>
                    Conectar con Canva Pro
                </button>
                <button class="canva-disconnect-btn" id="btnCanvaDisconnect" style="display: none;" onclick="disconnectCanva()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/>
                    </svg>
                    Desconectar
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
